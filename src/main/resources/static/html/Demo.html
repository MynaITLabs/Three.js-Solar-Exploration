<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>First Edition</title>

    <script src="../js/lib/jquery.min.js"></script>
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <script src="../js/lib/bootstrap.min.js"></script>

    <script src="../js/lib/three.min.js"></script>
    <script src="../js/utils/universeUtils.js"></script>
    <script src="../js/utils/utils.js"></script>
    <script src="../js/model/EarthSceneController.js"></script>
    <!--<script src="../js/model/changeScenePrototypeRE.js"></script>-->
    <script src="../js/model/SolarSystemSceneControllerRe.js"></script>
    <script src="../js/model/PlanetSceneControllersRe.js"></script>
    <script src="../js/model/GlobeScene.js"></script>

    <link rel="stylesheet" href="../css/index.css">

    <style>

        #backLogo {
            height: 100px;
            width: 100px;
            top: 10px;
            left: 10px;
            position: fixed;
            border-radius: 50%;
            border: 1px solid red;
        }

        #infoBoard {
            width: 100px;
            height: 100%;
            background-color: yellow;

        }

    </style>

</head>
<body>
<img id="backLogo" src="../images/solarLogo.jpg">
<canvas id="sceneArea"></canvas>
<!--<div id="infoBoard"></div>-->

<script>

    var geographicData = [
        {latitude: 39.92, longitude: 116.46},
        {latitude: 37.3382, longitude: -121.8863},
        {latitude: 55.45, longitude: 37.35},
        {latitude: 49, longitude: 2}
    ];

    var googleEarth = false;

    var renderer = SolarEPUtils.getDefaultRenderer();

    var solarSystemSceneController = new SolarSystemSceneController(renderer);
    var mercurySceneController = new MercurySceneController(renderer);
    var venusSceneController = new VenusSceneController(renderer);
    var earthSceneController = new EarthSceneController(renderer);
    var marsSceneController = new MarsSceneController(renderer);
    var jupiterSceneController = new JupiterSceneController(renderer);
    var saturnSceneController = new SaturnSceneController(renderer);
    var uranusSceneController = new UranusSceneController(renderer);
    var neptuneSceneController = new NeptuneSceneController(renderer);
    var plutoSceneController = new PlutoSceneController(renderer);

    // Cross setting Scene Controllers for each other
    mercurySceneController.setSolarSystemSceneController(solarSystemSceneController);
    venusSceneController.setSolarSystemSceneController(solarSystemSceneController);
    earthSceneController.setSolarSystemSceneController(solarSystemSceneController);
    marsSceneController.setSolarSystemSceneController(solarSystemSceneController);
    jupiterSceneController.setSolarSystemSceneController(solarSystemSceneController);
    saturnSceneController.setSolarSystemSceneController(solarSystemSceneController);
    uranusSceneController.setSolarSystemSceneController(solarSystemSceneController);
    neptuneSceneController.setSolarSystemSceneController(solarSystemSceneController);
    plutoSceneController.setSolarSystemSceneController(solarSystemSceneController);

    solarSystemSceneController.setPlanetScene("Mercury", mercurySceneController);
    solarSystemSceneController.setPlanetScene("Venus", venusSceneController);
    solarSystemSceneController.setPlanetScene("Earth", earthSceneController);
    solarSystemSceneController.setPlanetScene("Mars", marsSceneController);
    solarSystemSceneController.setPlanetScene("Jupiter", jupiterSceneController);
    solarSystemSceneController.setPlanetScene("Saturn", saturnSceneController);
    solarSystemSceneController.setPlanetScene("Uranus", uranusSceneController);
    solarSystemSceneController.setPlanetScene("Neptune", neptuneSceneController);
    solarSystemSceneController.setPlanetScene("Pluto", plutoSceneController);


    solarSystemSceneController.activateScene();
    var globe = new DAT.Globe(renderer);
    globe.setSurfaceImg("../images/world.jpg");
    globe.init();
    loadData();

    $(function () {

        $("#all").click(function () {
            $("body footer div").each(function () {
                $(this).attr("class", "unchecked");
            });
            $(this).attr("class", "checked");
            googleEarth = true;
            globe.animate();

        });

        $("body footer div.year").click(function () {
            $("body footer div").each(function () {
                $(this).attr("class", "unchecked");
            });
            $(this).attr("class", "checked");
            var year = $(this).text();

            if (googleEarth) {
                googleEarth = false;
                earthSceneController.animate()
            }

            getYearData(year);
        });

        $("#backLogo").click(function () {
            solarSystemSceneController.activateScene();
        });
    });

    function getYearData(year) {

        if (Math.random() > 0.5) {
            earthSceneController.addCones(geographicData);
        } else {
            earthSceneController.clearCones();
        }
    }

    function loadData() {

        $.ajax({
            url: '../data/rank.json',
//            url: '/api/all',
            type: 'GET',
            contentType: "application/json; charset=utf-8",
            async: true,
            dataType: 'json',
            success: function (data) {
                globe.addData(data, {format: 'magnitude'});
                globe.createPoints();
            }
        });
    }

</script>

<footer id="timeLine">
    <div class="checked year">2008</div>
    <div class="unchecked year">2009</div>
    <div class="unchecked year">2010</div>
    <div class="unchecked year">2011</div>
    <div class="unchecked year">2012</div>
    <div class="unchecked year">2013</div>
    <div class="unchecked year">2014</div>
    <div class="unchecked year">2015</div>
    <div class="unchecked year">2016</div>
    <div class="unchecked year">2017</div>
    <div id="all" class="unchecked">All</div>
</footer>

</body>
</html>